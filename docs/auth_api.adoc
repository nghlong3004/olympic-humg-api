== Auth API

'''

=== Introduction

Module `Auth` chịu trách nhiệm xác thực người dùng bằng JWT.

Tất cả request / response sử dụng JSON và UTF-8.

'''

=== Register

==== POST {api-base}auth/register

Tạo tài khoản mới trong hệ thống.

*Request*

_Method_

[source,subs="attributes+"]
----
POST {api-base}auth/register
----

_Headers_

[source]
----
Content-Type: application/json
----

_Body_

[source,json]
----
{
  "firstName": "Long",
  "lastName": "Nguyen",
  "email": "long@example.com",
  "password": "123456",
  "gender": "MALE",
  "birthday": "2004-03-30",
  "phone": "0987123456",
  "universityName": "HUMG",
  "facultyName": "Control Engineering"
}
----

*Response*

_201 Created_

_400 Bad Request_

[source,json]
----
{
  "timestamp": "2025-02-10T10:05:00Z",
  "status": 400,
  "message": "email is invalid or already exists."
}
----

'''

=== Login

==== POST {api-base}auth/login

Đăng nhập bằng email + password.

*Request*

_Method_

[source,subs="attributes+"]
----
POST {api-base}auth/login
----

_Headers_

[source]
----
Content-Type: application/json
----

_Body_

[source,json]
----
{
  "email": "long@example.com",
  "password": "123456"
}
----

*Response*

_200 OK_

_Body_

[source,json]
----
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs..."
}
----

_Headers_

[source]
----
Set-Cookie: refreshToken=eyJhbGciOiJIUzI1NiIs...;
  HttpOnly;
  Secure;
  SameSite=Strict;
  Path=/auth/refresh;
----

_401 Unauthorized_

[source,json]
----
{
  "timestamp": "2025-02-10T10:10:00Z",
  "status": 401,
  "message": "Email or password is incorrect."
}
----

'''

=== Refresh Token

==== POST {api-base}auth/refresh

Lấy `accessToken` mới bằng `refreshToken` được gửi tự động trong cookie `HttpOnly`.

*Request*

_Method_

[source,subs="attributes+"]
----
POST {api-base}auth/refresh
----

_Headers_

[source]
----
Content-Type: application/json
Cookie: refreshToken=eyJhbGciOiJIUzI1NiIs...
----

*Response*

_200 OK_

[source,json]
----
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs..."
}
----

_401 Unauthorized_

[source,json]
----
{
  "timestamp": "2025-02-10T10:20:00Z",
  "status": 401,
  "message": "Refresh token is invalid or expired."
}
----

'''

=== Logout

==== POST {api-base}auth/logout

Đăng xuất người dùng hiện tại.

*Request*

_Method_

[source,subs="attributes+"]
----
POST {api-base}auth/logout
----

_Headers_

[source]
----
Authorization: Bearer <accessToken>
Cookie: refreshToken=eyJhbGciOiJIUzI1NiIs...
----

*Response*

_204 No Content_

_401 Unauthorized_

[source,json]
----
{
  "timestamp": "2025-02-10T10:25:00Z",
  "status": 401,
  "message": "You must be logged in to perform this action."
}
----
