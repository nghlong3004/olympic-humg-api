<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="DEBUG">
    <Properties>
        <Property name="LOG_PATH">/var/log/template</Property>
        <Property name="LOG_FILE_NAME_ACCESS">/access</Property>
        <Property name="LOG_FILE_NAME_ERROR">/error</Property>
        <Property name="LOG_FILE_NAME_CONSOLE">/console</Property>
        <Property name="LOG_CONSOLE_PATTERN">%-5level %d{DEFAULT_PERIOD}[%logger{0}:%line] - %msg%ex%n</Property>
        <Property name="LOG_CONSOLE_FILE_PATTERN">%d{DEFAULT_PERIOD}[%equals{%X{trace_id}}{}{}] %msg%n</Property>
        <Property name="LOG_FILE_PATTERN">%d[{%X}]{DEFAULT_PERIOD} %msg%ex%n</Property>
    </Properties>

    <Appenders>
        <SpringProfile name="!local">
            <RollingFile name="accessLog" fileName="${LOG_PATH}${LOG_FILE_NAME_ACCESS}.log"
                         filePattern="${LOG_PATH}${LOG_FILE_NAME_ACCESS}.%d{yyyy-MM-dd}_%i.gz">
                <JsonTemplateLayout eventTemplateUri="classpath:logging/access-logging-template.json"/>
                <Policies>
                    <SizeBasedTriggeringPolicy size="50MB"/>
                    <TimeBasedTriggeringPolicy/>
                </Policies>
                <DefaultRolloverStrategy max="50"/>
            </RollingFile>
            <RollingFile name="errorLog" fileName="${LOG_PATH}${LOG_FILE_NAME_ERROR}.log"
                         filePattern="${LOG_PATH}${LOG_FILE_NAME_ERROR}.%d{yyyy-MM-dd}_%i.gz">
                <JsonTemplateLayout eventTemplateUri="classpath:logging/error-logging-template.json"/>
                <Policies>
                    <SizeBasedTriggeringPolicy size="50MB"/>
                    <TimeBasedTriggeringPolicy/>
                </Policies>
                <DefaultRolloverStrategy max="50"/>
            </RollingFile>
            <RollingFile name="consoleLog" fileName="${LOG_PATH}${LOG_FILE_NAME_CONSOLE}.log"
                         filePattern="${LOG_PATH}${LOG_FILE_NAME_CONSOLE}.%d{yyyy-MM-dd}_%i.gz">
                <JsonTemplateLayout eventTemplateUri="classpath:logging/common-logging-template.json" locationInfoEnabled="true"  stackTraceEnabled="true"/>
                <Policies>
                    <SizeBasedTriggeringPolicy size="50MB"/>
                    <TimeBasedTriggeringPolicy/>
                </Policies>
                <DefaultRolloverStrategy max="25"/>
            </RollingFile>
            <Console name="Console" target="SYSTEM_OUT">
                <PatternLayout pattern="${LOG_CONSOLE_PATTERN}"/>
            </Console>
        </SpringProfile>
        <SpringProfile name="local">
            <Console name="accessLog" target="SYSTEM_OUT">
                <PatternLayout pattern="${LOG_CONSOLE_PATTERN}"/>
            </Console>
            <Console name="errorLog" target="SYSTEM_OUT">
                <PatternLayout pattern="${LOG_CONSOLE_PATTERN}"/>
            </Console>
            <Console name="consoleLog" target="SYSTEM_OUT">
                <PatternLayout pattern="${LOG_CONSOLE_PATTERN}"/>
            </Console>
            <Console name="Console" target="SYSTEM_OUT">
                <PatternLayout pattern="${LOG_CONSOLE_PATTERN}"/>
            </Console>
        </SpringProfile>
    </Appenders>

    <Loggers>
        <Root level="INFO">
            <AppenderRef ref="Console"/>
        </Root>
        <Logger name="COMMON_LOGGER" level="INFO" includeLocation="true">
            <AppenderRef ref="consoleLog"/>
        </Logger>
        <Logger name="ACCESS_LOGGER" level="INFO" additivity="false">
            <AppenderRef ref="accessLog"/>
        </Logger>
        <Logger name="ERROR_LOGGER" level="ERROR" additivity="false">
            <AppenderRef ref="errorLog"/>
        </Logger>
        <Logger name="com.samsung" level="DEBUG"/>
        <Logger name="org.springframework.context" level="INFO"/>
    </Loggers>
</Configuration>
